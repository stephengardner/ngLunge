
<!-- Adding a location -->
<!-- End Adding a location -->
<!-- Locations table -->
<div class="locations"  ng-if="trainerFactory.trainer.locations.length">
    <!-- Locations table headers -->
    <div class="location-header">
        <div class="row gutter-small">
            <div class="col-xs-8 col-xxs-10" ng-class="{'col-xs-12 col-xxs-12' : !mapseditable}">
                Title
            </div>
            <div class="col-xs-8 col-xxs-10" ng-class="{'col-xs-12 col-xxs-12' : !mapseditable}">
                Address
            </div>
            <div ng-if="mapseditable" class="col-xxs-2 text-right visible-xxs">
                Delete
            </div>
            <div ng-if="mapseditable" class="col-xs-4 text-right visible-xs">
                Delete Location?
            </div>
        </div>
    </div>
    <!-- Locations list -->
    <div >
        <accordion close-others="false">
            <div cg-busy="{promise : cgBusy}">
                <accordion-group
                        ng-repeat="location in trainerFactory.trainer.locations | orderObjectBy:'primary'"
                        ng-if="location._id"
                        ng-click="triggerMarkerClick(location)"
                        is-open="accordionIndexViewable($index)" >
                    <div md-content>
                        <form class="location-editing-form form"
                              ng-class="{'editing' : location.editingTitle}"
                              name="locationEditingForm"
                              ng-submit="changeTitle(locationEditingForm, location)">
                            <div class="location"
                                 ng-class="{'primary' : location.primary,
                                 'selected' : isMarkerLocationSelected(location)}">
                                <div class="row gutter-small vertical-align">
                                    <!-- Location title -->
                                    <div ng-if="!location.editingTitle"
                                         class="location-title col-xxs-12"
                                         ng-class="{mapseditable : 'col-xs-10 col-xxs-11'}"
                                         ng-class="{'col-xs-12' : !mapseditable, 'col-md-24' : location.editingTitle}">
                                        <div class="name">
                                            <!-- Location primary icon -->
                                            <div class="primary-location-badge"
                                                 ng-if="location.primary && !location.editingTitle"
                                                 title="{{trainerFactory.trainer.name.first}}'s primary location">
                                                <i class="fa fa-star"></i>
                                            </div>
                                            {{ location.title }}
                                        </div>
                                        <!-- Location column edit buttons -->
                                        <div class="location-actions"
                                             ng-if="mapseditable && !location.editingTitle">
                                            <div stop-event
                                                 class="btn-text"
                                                 ng-click="toggleChangeTitle(location)">
                                                <i class="fa fa-font"></i> Change Title
                                            </div>
                                            <br/>
                                            <div stop-event
                                                 ng-if="!location.primary"
                                                 ng-click="makePrimary(location)"
                                                 class="btn-text">
                                                <i class="fa fa-star"></i> Make Primary
                                            </div>
                                        </div>
                                    </div>
                                    <!-- Location address -->
                                    <div class="col-xxs-12"
                                         ng-class="{mapseditable : 'col-xs-10 col-xxs-11'}"
                                         ng-if="!location.editingTitle"
                                         class='location-address col-xs-8 col-xxs-12'>
                                        <div class='address_line_1'>{{ location.address_line_1 }}</div>
                                        <div class='city-state'>{{ location.city + ', ' + location.state }}</div>
                                        <div class='zipcode'>{{ location.zipcode }}</div>
                                    </div>
                                    <div class="location-buttons col-xxs-2 col-xs-4 text-right"
                                         ng-controller="TrainerDeleteLocationController"
                                         ng-if="!location.editingTitle && mapseditable"
                                            >
                                        <div stop-event
                                             class="delete text-right visible-xxs-inline-block"
                                             ng-click="deleteLocationModal(location)"
                                             ng-disabled="location.removing">
                                            <i class="fa fa-times"></i>
                                        </div>
                                        <div stop-event
                                             class="btn btn-danger hidden-xxs"
                                             ng-click="deleteLocationModal(location)" ng-disabled="location.removing">
                                            <i ng-if="location.removing" class="fa fa-spin fa-spinner"></i>
                                            {{location.removing ? 'Removing' : 'Remove'}}
                                        </div>
                                    </div>
                                    <!-- Location editing title -->
                                    <div stop-event
                                         ng-if="location.editingTitle" class="col-xxs-24">
                                        <fieldset ng-disabled="ajax.busy">
                                            <md-input-container class="md-block">
                                                <label>Title</label>
                                                <input name="title"
                                                       ng-model="trainerFactory.trainerEditing.locations
                                                       [trainerFactory.trainer.locations.indexOf(location)].title"
                                                       ng-change="removeMongooseError(locationEditingForm, 'title')">
                                                <div ng-messages="locationEditingForm.title.$error"
                                                     class="md-auto-hide">
                                                    <div ng-message="mongoose">
                                                        {{locationEditingForm.title.$error.mongoose}}
                                                    </div>
                                                </div>
                                            </md-input-container>
                                            <div stop-event
                                                 class="buttons"
                                                 ng-class="{'row gutter-small' : location.editingTitle}">
                                            <span ng-class="{'col-xxs-12' : location.editingTitle}">
                                                <button stop-event ng-class="{'btn-block' : location.editingTitle}"
                                                        type="submit" class="btn btn-default">
                                                    Ok
                                                </button>
                                            </span>
                                            <span ng-class="{'col-xxs-12' : location.editingTitle}">
                                                <div stop-event class="btn btn-danger"
                                                     ng-class="{'btn-block' : location.editingTitle}" ng-click="toggleChangeTitle(location)">
                                                    Cancel
                                                </div>
                                            </span>
                                            </div>
                                        </fieldset>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                </accordion-group>
            </div>
        </accordion>
    </div>
    <!--
    <button class="btn btn-square btn-block btn-default" ng-hide="locations.length === trainer.locations.length"
            ng-click="limit = 4">Show More</button>
    <button class="btn btn-square btn-block btn-default" ng-if="locations.length >= trainer.locations.length"
            ng-click="limit = 1">Show Less</button>
            -->
    <button ng-if="trainerFactory.trainer.locations.length > 1" class="btn btn-square btn-block btn-info-alt"
            ng-click="toggleLimitLocations()">
        <span ng-if="locationsShowMore()"><i class="fa fa-chevron-down"></i> Show More</span>
        <span ng-if="!locationsShowMore()"><i class="fa fa-chevron-up"></i> Show Less</span>
    </button>

</div>
